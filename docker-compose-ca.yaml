# docker-compose-ca.yaml - Certificate Authorities for FYP Blockchain
# Hyperledger Fabric v2.5.14
#
# This file defines 6 CA containers:
# - OrdererOrg: Identity CA (7054) + TLS CA (8054)
# - LabOrg: Identity CA (7055) + TLS CA (8055)
# - CourtOrg: Identity CA (7056) + TLS CA (8056)

version: '3.7'

networks:
  fyp:
    name: fyp-blockchain-network

services:
  # OrdererOrg - Identity CA
  ca.ordererorg.example.com:
    image: hyperledger/fabric-ca:1.5.15
    container_name: ca.ordererorg.example.com
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.ordererorg.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=7054
      - FABRIC_CA_SERVER_OPERATIONS_LISTENADDRESS=0.0.0.0:17054
    ports:
      - "7054:7054"
      - "17054:17054"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - /home/user/FYPBcoc/crypto-config/ordererOrganizations/ordererorg.example.com/ca:/etc/hyperledger/fabric-ca-server
    networks:
      - fyp

  # OrdererOrg - TLS CA
  tlsca.ordererorg.example.com:
    image: hyperledger/fabric-ca:1.5.15
    container_name: tlsca.ordererorg.example.com
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=tlsca.ordererorg.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=8054
      - FABRIC_CA_SERVER_OPERATIONS_LISTENADDRESS=0.0.0.0:18054
    ports:
      - "8054:8054"
      - "18054:18054"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - /home/user/FYPBcoc/crypto-config/ordererOrganizations/ordererorg.example.com/tlsca:/etc/hyperledger/fabric-ca-server
    networks:
      - fyp

  # LabOrg - Identity CA
  ca.laborg.example.com:
    image: hyperledger/fabric-ca:1.5.15
    container_name: ca.laborg.example.com
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.laborg.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=7055
      - FABRIC_CA_SERVER_OPERATIONS_LISTENADDRESS=0.0.0.0:17055
    ports:
      - "7055:7055"
      - "17055:17055"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - /home/user/FYPBcoc/crypto-config/peerOrganizations/laborg.example.com/ca:/etc/hyperledger/fabric-ca-server
    networks:
      - fyp

  # LabOrg - TLS CA
  tlsca.laborg.example.com:
    image: hyperledger/fabric-ca:1.5.15
    container_name: tlsca.laborg.example.com
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=tlsca.laborg.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=8055
      - FABRIC_CA_SERVER_OPERATIONS_LISTENADDRESS=0.0.0.0:18055
    ports:
      - "8055:8055"
      - "18055:18055"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - /home/user/FYPBcoc/crypto-config/peerOrganizations/laborg.example.com/tlsca:/etc/hyperledger/fabric-ca-server
    networks:
      - fyp

  # CourtOrg - Identity CA
  ca.courtorg.example.com:
    image: hyperledger/fabric-ca:1.5.15
    container_name: ca.courtorg.example.com
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.courtorg.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=7056
      - FABRIC_CA_SERVER_OPERATIONS_LISTENADDRESS=0.0.0.0:17056
    ports:
      - "7056:7056"
      - "17056:17056"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - /home/user/FYPBcoc/crypto-config/peerOrganizations/courtorg.example.com/ca:/etc/hyperledger/fabric-ca-server
    networks:
      - fyp

  # CourtOrg - TLS CA
  tlsca.courtorg.example.com:
    image: hyperledger/fabric-ca:1.5.15
    container_name: tlsca.courtorg.example.com
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=tlsca.courtorg.example.com
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_PORT=8056
      - FABRIC_CA_SERVER_OPERATIONS_LISTENADDRESS=0.0.0.0:18056
    ports:
      - "8056:8056"
      - "18056:18056"
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - /home/user/FYPBcoc/crypto-config/peerOrganizations/courtorg.example.com/tlsca:/etc/hyperledger/fabric-ca-server
    networks:
      - fyp
